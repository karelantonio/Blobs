#:kivy 2.3.1

# New event screen
<NewEventScreen>:
    BoxLayout:
        id: content
        orientation: 'vertical'
        
        MDTopAppBar:
            type: 'small'
            pos_hint: {"center_x": .5, "center_y": .5}

            MDTopAppBarLeadingButtonContainer:
                MDActionTopAppBarButton:
                    on_release: root.manager.current = 'overview'
                    icon: 'arrow-left'

            MDTopAppBarTitle:
                text: "New Event"
                halign: 'center'

            MDTopAppBarTrailingButtonContainer:
                MDActionTopAppBarButton:
                    on_release: root.manager.current = 'new_event'
                    icon: 'check'

        MDTabsPrimary:
            id: tabs
            pos_hint: {'center_x': .5, 'center_y': .5}
            size_hint_y: 1

            MDTabsItem:
                MDTabsItemIcon:
                    icon: 'information-outline'
                MDTabsItemText:
                    text: 'Event'
            
            MDTabsItem:
                MDTabsItemIcon:
                    icon: 'clock-outline'
                MDTabsItemText:
                    text: 'Time'
            
            MDTabsItem:
                MDTabsItemIcon:
                    icon: 'hammer'
                MDTabsItemText:
                    text: 'Resources'

            MDDivider:

            MDTabsCarousel:
                id: tabs_content
                
                # TAB EVENT
                MDBoxLayout:
                    orientation: 'vertical'

                    MDBoxLayout:
                        orientation: 'vertical'
                        adaptive_height: False
                        spacing: dp(0)
                        padding: dp(4)

                        MDCard:
                            size_hint_y: None
                            radius: dp(26)
                            adaptive_height: True
                            on_release: root.show_event_chooser_dialog()

                            MDBoxLayout:
                                orientation: 'horizontal'

                                FitImage:
                                    size_hint: .3, 1
                                    source: root.event_tpl_icon
                                    radius: dp(24), 0, 0, dp(24)

                                Widget:
                                    size_hint_x: None
                                    width: dp(8)

                                MDBoxLayout:
                                    orientation: 'vertical'

                                    Widget:
                                        size_hint_y: None
                                        height: dp(8)

                                    MDLabel:
                                        text: root.event_tpl_name

                                    MDLabel:
                                        text: root.event_tpl_description
                                    
                                    Widget:
                                        size_hint_y: None
                                        height: dp(8)

                        # End of the card boxlayout

                        MDLabel:
                            size_hint_y: None
                            font_style: 'Title'
                            text: 'Requirements:'

                        MDRecycleView:
                            id: requirements
                            do_scroll_x: False
                            do_scroll_y: True
                            viewclass: 'NewEventReq'

                            RecycleBoxLayout:
                                default_size_hint: 1, None
                                default_size: None, dp(80)
                                size_hint_y: None
                                height: self.minimum_height
                                orientation: 'vertical'

                # TAB TIME
                MDBoxLayout:
                    spacing: 0
                    padding: dp(8)
                    orientation: 'vertical'

                    MDLabel:
                        text: 'Start time:'
                        size_hint_y: None
                        font_style: 'Title'

                    MDTextField:
                        id: date
                        mode: 'filled'
                        size_hint_y: None
                        on_focus: root.show_date_picker(self, self.focus)

                        MDTextFieldHintText:
                            text: 'Start Date'

                        MDTextFieldHelperText:
                            text: 'DD/MM/YYYY'
                    
                    MDBoxLayout:
                        padding: [0, dp(8), 0, 0]
                        size_hint_y: None

                        MDTextField:
                            id: time
                            mode: 'filled'
                            size_hint_y: None
                            on_focus: root.show_time_picker(self, self.focus)

                            MDTextFieldHintText:
                                text: 'Time'

                            MDTextFieldHelperText:
                                text: 'HH:MM'
                    
                    MDBoxLayout:
                        padding: [0, dp(8), 0, 0]
                        size_hint_y: None

                        MDTextField:
                            mode: 'filled'
                            size_hint_y: None

                            MDTextFieldHintText:
                                text: 'Duration (hours)'

                            MDTextFieldHelperText:
                                text: 'It must be an integer'

                    Widget:
                        size_hint_y: 1

                # TAB RESOURCES
                MDBoxLayout:
                    orientation: 'vertical'
                    spacing: 0
                    padding: dp(4)

                    MDLabel:
                        size_hint_y: None
                        font_style: 'Title'
                        text: 'Resources:'

                    MDRecycleView:
                        id: resources_rv
                        data: root.resources
                        do_scroll_x: False
                        do_scroll_y: True
                        viewclass: 'NewEventRes'

                        RecycleBoxLayout:
                            default_size_hint: 1, None
                            default_size: None, dp(80)
                            size_hint_y: None
                            height: self.minimum_height
                            orientation: 'vertical'
            

<EventChooserDialog>:
    MDDialogHeadlineText:
        text: 'Select an event template'

    MDDialogContentContainer:
        orientation: 'vertical'
        id: container
    
<EventChooserDialogItem>:
    on_release: self.selected()

    MDListItemLeadingAvatar:
        source: root.image

    MDListItemSupportingText:
        text: root.title

<NewEventReq>:
    size_hint_y: None
    orientation: 'horizontal'

    # qnty
    MDLabel:
        size_hint_x: None
        pos_hint_y: 0.5
        text: root.qty

    FitImage:
        size_hint_x: None
        source: root.icon

    Widget:
        size_hint: None, None
        width: dp(8)

    MDLabel:
        font_style: 'Title'
        text: root.name

<NewEventRes>:
    size_hint_y: None
    orientation: 'horizontal'

    # qnty
    MDLabel:
        size_hint_x: None
        text: f"{root.qty} x"

    FitImage:
        size_hint_x: None
        source: root.icon

    Widget:
        size_hint: None, None
        width: dp(8)

    MDLabel:
        font_style: 'Title'
        text: root.name
