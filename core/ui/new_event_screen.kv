#:kivy 2.3.1

# New event screen
<NewEventScreen>:
    BoxLayout:
        id: content
        orientation: 'vertical'
        
        MDTopAppBar:
            type: 'small'
            pos_hint: {"center_x": .5, "center_y": .5}

            MDTopAppBarLeadingButtonContainer:
                MDActionTopAppBarButton:
                    on_release: root.manager.current = 'overview'
                    icon: 'arrow-left'

            MDTopAppBarTitle:
                text: "New Event"
                halign: 'center'

            MDTopAppBarTrailingButtonContainer:
                MDActionTopAppBarButton:
                    on_release: root.manager.current = 'new_event'
                    icon: 'check'

        MDBoxLayout:
            pos_hint: {'y': 0}
            orientation: 'vertical'
            adaptive_height: False
            spacing: dp(0)
            padding: dp(4)

            MDCard:
                size_hint_y: None
                radius: dp(26)
                adaptive_height: True
                on_release: root.show_event_chooser_dialog()

                MDBoxLayout:
                    orientation: 'horizontal'

                    FitImage:
                        size_hint: .3, 1
                        source: root.event_tpl_icon
                        radius: dp(24), 0, 0, dp(24)

                    Widget:
                        size_hint_x: None
                        width: dp(8)

                    MDBoxLayout:
                        orientation: 'vertical'

                        Widget:
                            size_hint_y: None
                            height: dp(8)

                        MDLabel:
                            text: root.event_tpl_name

                        MDLabel:
                            text: root.event_tpl_description
                        
                        Widget:
                            size_hint_y: None
                            height: dp(8)

            # End of the card boxlayout

            # Requirements section
            MDLabel:
                size_hint_y: None
                font_style: 'Headline'
                text: 'Requirements:'

            Widget:
                size_hint_y: None
                height: dp(4)

            MDRecycleView:
                id: requirements
                size_hint_y: .5
                do_scroll_x: False
                do_scroll_y: True
                viewclass: 'NewEventReq'

                RecycleBoxLayout:
                    default_size_hint: 1, None
                    default_size: None, dp(80)
                    size_hint_y: None
                    height: self.minimum_height
                    orientation: 'vertical'

            MDDivider:
                size_hint_y: None

            MDLabel:
                size_hint_y: None
                font_style: 'Headline'
                text: 'Resources:'

            Widget:
                size_hint_y: None
                height: dp(4)

            MDRecycleView:
                id: resources_rv
                data: root.resources
                size_hint_y: .5
                do_scroll_x: False
                do_scroll_y: True
                viewclass: 'NewEventRes'

                RecycleBoxLayout:
                    default_size_hint: 1, None
                    default_size: None, dp(80)
                    size_hint_y: None
                    height: self.minimum_height
                    orientation: 'vertical'
            

<EventChooserDialog>:
    MDDialogHeadlineText:
        text: 'Select an event template'

    MDDialogContentContainer:
        orientation: 'vertical'
        id: container
    
<EventChooserDialogItem>:
    on_release: self.selected()

    MDListItemLeadingAvatar:
        source: root.image

    MDListItemSupportingText:
        text: root.title

<NewEventReq>:
    size_hint_y: None
    orientation: 'horizontal'

    # qnty
    MDLabel:
        size_hint_x: None
        pos_hint_y: 0.5
        text: root.qty

    FitImage:
        size_hint_x: None
        source: root.icon

    Widget:
        size_hint: None, None
        width: dp(8)

    MDLabel:
        font_style: 'Title'
        text: root.name

<NewEventRes>:
    size_hint_y: None
    orientation: 'horizontal'

    # qnty
    MDLabel:
        size_hint_x: None
        text: f"{root.qty} x"

    FitImage:
        size_hint_x: None
        source: root.icon

    Widget:
        size_hint: None, None
        width: dp(8)

    MDLabel:
        font_style: 'Title'
        text: root.name
